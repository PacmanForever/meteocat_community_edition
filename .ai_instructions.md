# AI Assistant Instructions Template for Home Assistant Integrations

This document provides comprehensive guidance for AI assistants (like GitHub Copilot, Cursor, or other coding assistants) working on Home Assistant custom integration projects.

**‚ö†Ô∏è This is a template - customize for your specific integration**

Before using this template:
1. Replace `[Integration Name]`, `[integration_domain]`, etc. with actual values
2. **Fill in `REQUIREMENTS_TEMPLATE.md`** with your integration's detailed specifications
3. Update API documentation links
4. Add project-specific code examples
5. Customize quality standards as needed
6. Update file structure examples with actual filenames

## üöÄ Quick Start for New AI Agents

**What is this project?**
This is a Home Assistant (HA) custom integration project compatible with HACS (Home Assistant Community Store). The integration follows HA development standards and aims for Silver Quality Level certification.

**What should I do?**
- Help develop and maintain the integration code
- Write comprehensive tests (unit + component)
- Ensure >95% code coverage and HA Silver Quality Level
- Follow HA development standards and best practices
- Assist with bug fixes, new features, and documentation

**Where do I find information?**
1. **This file** (`.ai_instructions.md`): Current AI guidelines
2. **`REQUIREMENTS_TEMPLATE.md`**: Detailed project requirements and specifications
3. **`docs/HA_HACS_Integration_Creation_Guide.md`**: Complete project setup guide
4. **`README.md`**: Project overview, installation, features
5. **`CONTRIBUTING.md`**: Development guidelines and processes
6. **`QUALITY.md`**: Quality standards and testing requirements
7. **`tests/README.md`**: Testing documentation and setup
8. **Code files**: Check docstrings and comments for implementation details

## üìã Project Context

### Integration Overview
- **Name**: [Integration Name]
- **Domain**: [integration_domain]
- **Purpose**: [Brief description of what the integration does]
- **API**: [External API or service used]
- **Distribution**: HACS (Home Assistant Community Store)
- **Quality Target**: HA Silver Level (>95% coverage)

### Key Requirements
- **Language**: Python 3.11+
- **Framework**: Home Assistant custom component
- **Quality**: >95% test coverage, PEP 8 compliance
- **Structure**: Standard HA integration layout in `custom_components/`
- **Testing**: Unit tests + Component tests
- **CI/CD**: GitHub Actions for validation and testing
- **Translations**: Support for multiple languages as needed

**üìã For project-specific requirements, see `REQUIREMENTS_TEMPLATE.md`**

## Code Style Guidelines

### Python Standards
- Follow PEP 8 with 88 character line length
- Use type hints for all function parameters and return values
- Write comprehensive docstrings for classes and functions
- Use descriptive variable names
- Prefer f-strings over .format() or % formatting

### Home Assistant Specific
- Use async/await for all I/O operations
- Implement proper error handling with HA logging
- Follow the coordinator pattern for API polling
- Use HA's built-in translation system
- Implement config flow for user-friendly setup

## File Structure Expectations

When creating new files, follow this structure:
```
custom_components/integration_domain/
‚îú‚îÄ‚îÄ __init__.py          # Integration setup
‚îú‚îÄ‚îÄ config_flow.py       # Configuration flow
‚îú‚îÄ‚îÄ coordinator.py       # Data coordination
‚îú‚îÄ‚îÄ sensor.py           # Sensor entities
‚îú‚îÄ‚îÄ const.py            # Constants
‚îú‚îÄ‚îÄ strings.json        # Translations
‚îî‚îÄ‚îÄ manifest.json       # Integration metadata
```

## Testing Requirements

### Unit Tests
- Test individual functions and classes in isolation
- Mock external dependencies (API calls, HA components)
- Cover happy path and error scenarios
- Aim for >95% coverage

### Component Tests
- Test integration within HA environment
- Verify entity creation and updates
- Test configuration flows
- Validate error handling

## Common Patterns

### API Integration
```python
class MyCoordinator(DataUpdateCoordinator):
    def __init__(self, hass, api_key):
        super().__init__(
            hass,
            _LOGGER,
            name=DOMAIN,
            update_interval=timedelta(minutes=15)
        )
        self.api_key = api_key

    async def _async_update_data(self):
        try:
            # API call here
            return await self.api.fetch_data()
        except Exception as err:
            raise UpdateFailed(f"Error fetching data: {err}")
```

### Entity Creation
```python
class MySensor(CoordinatorEntity, SensorEntity):
    def __init__(self, coordinator, config_entry):
        super().__init__(coordinator)
        self._config_entry = config_entry

    @property
    def name(self):
        return f"My Sensor {self._config_entry.data['name']}"

    @property
    def state(self):
        return self.coordinator.data.get('value')
```

## Git Workflow

- Create feature branches from `main`
- Use descriptive commit messages
- Ensure all tests pass before pushing
- Create pull requests for review

## Quality Checks

Before committing:
1. Run tests: `pytest tests/`
2. Check coverage: `pytest --cov=custom_components.integration_domain`
3. Validate with HA: `hassfest`
4. Check HACS compatibility

## ü§ñ AI Assistant Commands

When working with this codebase, AI assistants should:

### Information Gathering
1. **Always read this file** before starting any work
2. **Check relevant documentation** before implementing features
3. **Review existing code patterns** for consistency
4. **Examine test files** to understand expected behavior
5. **Check CHANGELOG.md** for recent changes

### Development Process
1. **Follow established patterns** from existing code
2. **Include comprehensive tests** for all new functionality
3. **Add proper documentation** (docstrings, comments, type hints)
4. **Maintain code quality** (PEP 8, HA standards)
5. **Ensure backward compatibility** unless breaking changes are planned

### Quality Assurance
1. **Run all tests** before committing
2. **Check test coverage** remains >95%
3. **Validate with HA tools** (hassfest, HACS action)
4. **Test multiple Python versions** (3.11, 3.12)
5. **Verify translations** are complete

### Documentation Updates
1. **Update this file** when processes change
2. **Keep documentation current** with code changes
3. **Add examples** for new patterns
4. **Review and update** guidelines regularly
5. **Document breaking changes** clearly

### Communication
1. **Explain complex decisions** in comments/docstrings
2. **Suggest improvements** to processes when identified
3. **Ask for clarification** when requirements are unclear
4. **Document assumptions** when making implementation choices

## üìù Contributing to These Instructions

### When to Update This File
- **New technologies** are introduced to the project
- **Processes change** (testing, deployment, etc.)
- **New patterns** emerge in the codebase
- **Quality standards** evolve
- **Team feedback** identifies gaps in guidance

### How to Update
1. **Propose changes** via pull request
2. **Include rationale** for changes in PR description
3. **Test new guidance** on sample implementations
4. **Ensure clarity** for both human and AI readers
5. **Keep it current** with project evolution

### Review Process
- Changes to this file should be reviewed by maintainers
- Updates should be tested on real development tasks
- Feedback from AI assistants using these instructions is valuable

---

**Template Version**: 1.0
**Last Updated**: December 2025
**For**: Home Assistant Integration Projects
**Customize for**: Your specific integration

## üìö Information Sources

### Primary Documentation
- **`README.md`**: Installation, features, configuration examples
- **`CONTRIBUTING.md`**: How to contribute, coding standards, PR process
- **`QUALITY.md`**: Testing requirements, quality standards
- **`CHANGELOG.md`**: Version history and release notes
- **`docs/HA_HACS_Integration_Creation_Guide.md`**: Complete setup guide for similar projects

### Code Documentation
- **Docstrings**: Every class, method, and function has comprehensive documentation
- **Comments**: Inline comments explain complex logic
- **Type hints**: All parameters and return values are typed
- **`const.py`**: All constants with descriptions
- **`strings.json`**: Translation keys and their purposes

### Testing Documentation
- **`tests/README.md`**: Testing setup and guidelines
- **Test files**: Each test file documents what it tests
- **Coverage reports**: Generated in `htmlcov/` directory

### External Resources
- [HA Developer Docs](https://developers.home-assistant.io/): Official HA development documentation
- [HACS Guidelines](https://hacs.xyz/docs/publish/start): HACS publishing requirements
- [API Documentation]: [Link to the specific API/service documentation]
- [PEP 8](https://pep8.org/): Python style guide

## üîÑ Staying Updated

### How to Check for Updates
1. **Read this file first** when starting work on the project
2. **Check CHANGELOG.md** for recent changes and new features
3. **Review recent commits** for implementation changes
4. **Run tests** to understand current functionality
5. **Check GitHub Issues/PRs** for ongoing work

### When Requirements Change
If you encounter new requirements or changes:

1. **Update relevant documentation** immediately
2. **Modify this AI instructions file** if processes change
3. **Update tests** to reflect new functionality
4. **Ensure CI/CD workflows** still pass
5. **Document breaking changes** in CHANGELOG.md

### Updating These Instructions
When project requirements evolve:

1. **Add new sections** for new processes or technologies
2. **Update code examples** to reflect current patterns
3. **Modify quality requirements** if standards change
4. **Add new information sources** as documentation grows
5. **Review and update** this file quarterly or when major changes occur